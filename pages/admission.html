<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Police Modern School Admission Form</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/logo/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../assets/images/logo/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../assets/images/logo/apple-touch-icon.png">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Times+New+Roman&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Tiro Devanagari Hindi',
                'Segoe UI',
                Tahoma,
                Geneva,
                Verdana,
                sans-serif;
            padding-top: 120px;
            /* Add padding for fixed header */
        }

        /* Header specific styles to match index.html */
        :root {
            --color-primary: #1e3a8a;
            --color-secondary: #facc15;
            --color-accent: #3b82f6;
            --color-soft: #f3f4f6;
        }

        .bg-primary {
            background-color: var(--color-primary) !important;
        }

        .text-primary {
            color: var(--color-primary) !important;
        }

        .text-secondary {
            color: var(--color-secondary) !important;
        }

        .bg-secondary {
            background-color: var(--color-secondary) !important;
        }

        .step-content {
            display: none;
        }

        .step-content.active {
            display: block;
        }

        /* Preview Styling */
        .preview-document {
            font-family: 'Times New Roman', Times, serif;
            width: 210mm;
            min-height: 297mm;
            padding: 10mm;
            margin: auto;
            background: white;
            color: black;
            border: 1px solid #ccc;
            font-size: 11px;
            line-height: 1.3;
        }

        .preview-document p {
            margin: 4px 0;
        }

        .preview-document .space-y-4>*+* {
            margin-top: 8px !important;
        }

        .dotted-line {
            border-bottom: 1px dotted #000;
            display: inline-block;
            min-width: 100px;
            padding: 0 5px;
            font-weight: bold;
        }

        @media print {
            body * {
                visibility: hidden;
            }

            #finalPreviewPage,
            #finalPreviewPage * {
                visibility: visible;
            }

            #finalPreviewPage {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                border: none;
            }

            .no-print {
                display: none;
            }
        }

        .student-photo-placeholder {
            width: 120px;
            height: 150px;
            border: 1px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 10px;
            overflow: hidden;
            background-color: #f9f9f9;
        }

        .step-photo-preview {
            width: 100px;
            height: 120px;
            border: 2px dashed #cbd5e1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            overflow: hidden;
            background: #fff;
        }
    </style>
</head>

<body class="p-4 md:p-8">

    <!-- Navigation -->
    <nav id="navbar" class="fixed top-0 left-0 w-full z-50 bg-primary shadow-lg text-white">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center relative">
            <!-- Logo -->
            <a href="../index.html" class="flex items-center gap-3 group">
                <img src="../assets/images/logo/logo.png" alt="Police Modern School Logo"
                    class="w-12 h-12 object-contain rounded-lg shadow-lg group-hover:scale-110 transition-transform">
                <div class="flex flex-col">
                    <span
                        class="text-3xl md:text-4xl font-bold tracking-wide leading-tight group-hover:text-secondary transition-colors">पुलिस
                        मॉडर्न स्कूल रायबरेली</span>
                    <span class="text-lg font-medium opacity-90">25वीं वाहिनी पीएसी, रायबरेली</span>
                </div>
            </a>

            <!-- Desktop Menu -->
            <div class="hidden lg:flex space-x-6 items-center font-medium text-sm lg:text-base">
                <a href="../index.html" class="hover:text-secondary transition-colors">मुख्य पृष्ठ</a>
                <a href="login.html" class="flex items-center gap-2 hover:text-secondary transition-colors">
                    <i class="fas fa-user-lock"></i>लॉगिन
                </a>
            </div>
        </div>
    </nav>

    <!-- Language Switcher Fixed Button -->
    <div class="fixed top-4 right-4 z-50 no-print">
        <button onclick="toggleLanguage()"
            class="bg-blue-800 text-white px-4 py-2 rounded-full shadow-lg font-bold hover:bg-blue-900 transition flex items-center gap-2 border-2 border-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M7 2a1 1 0 011 1v1h3a1 1 0 110 2H9.578a5.982 5.982 0 013.561 2.662 4.504 4.504 0 002.322-.504.75.75 0 01.75 1.3c-.737.425-1.607.592-2.403.465a6.01 6.01 0 01-3.437 3.366 12.02 12.02 0 01.776 1.702.75.75 0 11-1.352.65 10.515 10.515 0 00-.73-1.582 10.259 10.259 0 01-5.272-3.67.75.75 0 111.125-1.002 8.759 8.759 0 004.49 3.126 4.507 4.507 0 00-2.477-3.418.75.75 0 01.344-1.418H7V3a1 1 0 011-1zm1.99 4H4.21a4.503 4.503 0 001.546 3.027c.54.45.998.78 1.322 1.018.351.258.643.477.896.721.253-.244.545-.463.896-.721.324-.237.782-.568 1.322-1.018A4.503 4.503 0 009.79 6H8.99z"
                    clip-rule="evenodd" />
            </svg>
            <span id="langLabel">हिन्दी</span>
        </button>
    </div>

    <div class="max-w-4xl mx-auto">
        <!-- Progress Bar -->
        <div class="mb-8 no-print" id="progressContainer">
            <div class="flex justify-between mb-2">
                <span
                    class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200"
                    id="stepIndicator">
                    Step 1 of 8
                </span>
                <span
                    class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200"
                    id="stepName">
                    Scholar Details
                </span>
            </div>
            <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200">
                <div id="progressBar" style="width: 14.28%"
                    class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500">
                </div>
            </div>
        </div>

        <form id="admission-form" class="bg-white p-8 rounded-2xl shadow-xl no-print">

            <!-- STEP 1: Scholar Details -->
            <div class="step-content active" id="step1">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s1_title">Step 1: Scholar
                    Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700" data-key="scholar_name">1:- Name of
                                Scholar <span class="text-red-500">*</span></label>
                            <input type="text" name="scholarName" required
                                class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none shadow-sm">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700" data-key="dob">Date of Birth <span
                                    class="text-red-500">*</span></label>
                            <input type="date" name="dob" required
                                class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none shadow-sm">
                            <p class="text-xs text-gray-500 mt-1">Format: mm/dd/yyyy</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700" data-key="gender">Gender <span
                                    class="text-red-500">*</span></label>
                            <select name="gender" required
                                class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none shadow-sm cursor-pointer">
                                <option value="" data-key="select_gender">-- Select Gender --</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700" data-key="target_class">Class to
                                which admission is sought <span class="text-red-500">*</span></label>
                            <select name="targetClass" required
                                class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none shadow-sm cursor-pointer">
                                <option value="" data-key="select_class">-- Select Class --</option>
                                <option value="LKG">LKG</option>
                                <option value="UKG">UKG</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                            </select>
                        </div>
                    </div>

                    <div class="flex flex-col items-center justify-center border-l border-gray-100 pl-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2 text-center"
                            data-key="photo_label">Student Photo Preview</label>
                        <div id="instantPhotoPreview" class="step-photo-preview mb-4 shadow-inner">
                            <span class="text-gray-400 text-xs text-center p-2" data-key="no_photo">No photo
                                selected</span>
                        </div>
                        <input type="file" id="studentPhotoInput" name="photo" accept=".jpg, .jpeg, .png"
                            class="text-xs text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"
                            onchange="handleInstantPreview(this)">
                        <p class="text-[10px] text-red-500 mt-2 text-center font-semibold">
                            Max size: 500KB. Formats: JPG, PNG, JPEG only.
                        </p>
                    </div>
                </div>
            </div>

            <!-- STEP 2: Parents Details -->
            <div class="step-content" id="step2">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s2_title">Step 2: Parents
                    Details</h2>
                <div class="space-y-6">
                    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                        <h3 class="font-bold text-gray-800 mb-4 underline decoration-blue-300 underline-offset-4"
                            data-key="father_head">Father's Information</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="md:col-span-1">
                                <label class="block text-sm font-medium text-gray-700" data-key="father_name">Father's
                                    Name <span class="text-red-500">*</span></label>
                                <input type="text" name="fatherName" required
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                            <div class="md:col-span-1">
                                <label class="block text-sm font-medium text-gray-700" data-key="father_occupation">
                                    Occupation <span class="text-red-500">*</span></label>
                                <input type="text" name="fatherOcc" required
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>

                            <div class="md:col-span-2 mt-2 bg-orange-50 border-l-4 border-orange-400 p-2">
                                <p class="text-[11px] text-orange-800 font-bold uppercase tracking-wide"
                                    data-key="police_note">Note: Fill Company and Post only if Father is a Police
                                    Employee.</p>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700"
                                    data-key="company">Company</label>
                                <input type="text" name="fCompany"
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-key="post">Post</label>
                                <input type="text" name="fPost"
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-key="mobile">Mobile
                                    No. <span class="text-red-500">*</span></label>
                                <input type="text" name="fMobile" required
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Email ID</label>
                                <input type="email" name="parentEmail"
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg"
                                    placeholder="example@gmail.com">
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-xl border border-gray-200">
                        <h3 class="font-bold text-gray-800 mb-4 underline decoration-blue-300 underline-offset-4"
                            data-key="mother_head">Mother's Information</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-key="mother_name">Mother's
                                    Name <span class="text-red-500">*</span></label>
                                <input type="text" name="motherName" required
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700" data-key="mother_occ">Mother's
                                    Occupation</label>
                                <input type="text" name="motherOcc"
                                    class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 3: Address Details -->
            <div class="step-content" id="step3">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s3_title">Step 3: Address
                    Details</h2>
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-key="perm_addr">Permanent
                            Address <span class="text-red-500">*</span></label>
                        <textarea name="permAddress" rows="3" required
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-key="post_addr">Postal
                            Address</label>
                        <textarea name="postAddress" rows="3"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"></textarea>
                    </div>
                </div>
            </div>

            <!-- STEP 4: Local Guardian Details -->
            <div class="step-content" id="step4">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s4_title">Step 4: Local
                    Guardian</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700" data-key="g_name">Guardian Name</label>
                        <input type="text" name="gName" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700" data-key="g_addr">Guardian
                            Address</label>
                        <input type="text" name="gAddress"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-key="g_rel">Relationship with
                            Scholar</label>
                        <input type="text" name="gRel" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                </div>
            </div>

            <!-- STEP 5: Other Info -->
            <div class="step-content" id="step5">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s5_title">Step 5: Educational
                    & Personal Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700" data-key="last_inst">Last Institution
                            Attended</label>
                        <input type="text" name="lastInst" id="lastInstInput" oninput="handleLastInstChange()"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-key="tongue">Mother Tongue</label>
                        <input type="text" name="tongue"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-key="religion">Religion &
                            Caste</label>
                        <input type="text" name="religion"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700" data-key="stay_up">Duration of stay in
                            U.P.</label>
                        <input type="text" name="stayUp"
                            class="mt-1 block w-full p-3 border border-gray-300 rounded-lg">
                    </div>

                </div>
            </div>

            <!-- STEP 6: Required Documents -->
            <div class="step-content" id="step6">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s6_title">Step 6: Required
                    Documents
                </h2>
                <div class="space-y-6">
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                        <p class="text-sm text-yellow-700" data-key="doc_note">
                            Please upload all required documents in image format (JPEG, PNG) only. Maximum file size:
                            1MB per
                            document.
                        </p>
                    </div>

                    <!-- Birth Certificate -->
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-key="birth_cert">
                            Birth Certificate <span class="text-red-500">*</span>
                        </label>
                        <input type="file" id="birthCert" name="birthCert" accept=".jpg,.jpeg,.png"
                            class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"
                            onchange="handleDocumentUpload(this, 'birthCertPreview')">
                        <div id="birthCertPreview" class="mt-2 text-xs text-gray-600"></div>
                        <div id="birthCertImage" class="mt-3"></div>
                    </div>

                    <!-- Aadhar Card -->
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-key="aadhar_card">
                            Aadhar Card
                        </label>
                        <input type="file" id="aadharCard" name="aadharCard" accept=".jpg,.jpeg,.png"
                            class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"
                            onchange="handleDocumentUpload(this, 'aadharCardPreview')">
                        <div id="aadharCardPreview" class="mt-2 text-xs text-gray-600"></div>
                        <div id="aadharCardImage" class="mt-3"></div>
                    </div>

                    <!-- Caste Certificate -->
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-key="caste_cert">
                            Caste Certificate
                        </label>
                        <input type="file" id="casteCert" name="casteCert" accept=".jpg,.jpeg,.png"
                            class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"
                            onchange="handleDocumentUpload(this, 'casteCertPreview')">
                        <div id="casteCertPreview" class="mt-2 text-xs text-gray-600"></div>
                        <div id="casteCertImage" class="mt-3"></div>
                    </div>

                    <!-- Domicile Certificate -->
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <label class="block text-sm font-medium text-gray-700 mb-2" data-key="domicile_cert">
                            Domicile Certificate
                        </label>
                        <input type="file" id="domicileCert" name="domicileCert" accept=".jpg,.jpeg,.png"
                            class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 cursor-pointer"
                            onchange="handleDocumentUpload(this, 'domicileCertPreview')">
                        <div id="domicileCertPreview" class="mt-2 text-xs text-gray-600"></div>
                        <div id="domicileCertImage" class="mt-3"></div>
                    </div>

                    <!-- Preview Section -->
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-200 mt-6">
                        <h3 class="font-semibold text-blue-900 mb-3" data-key="uploaded_docs">
                            <i class="fas fa-file-pdf mr-2"></i>Uploaded Documents
                        </h3>
                        <div id="documentsPreviewList" class="space-y-2 text-sm text-gray-700">
                            <p class="text-gray-500 italic" data-key="no_docs_uploaded">No documents uploaded yet</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STEP 7: Declarations -->
            <div class="step-content" id="step7">
                <h2 class="text-2xl font-bold mb-6 text-blue-900 border-b pb-2" data-key="s7_title">Step 7: Declaration
                </h2>
                <div class="space-y-6">
                    <div class="flex items-start bg-blue-50 p-3 rounded-xl border border-blue-100" id="cert1Container">
                        <input type="checkbox" id="cert1" class="mt-1 h-5 w-5 text-blue-600 rounded cursor-pointer">
                        <label for="cert1" class="ml-4 text-sm text-gray-700 leading-relaxed font-semibold"
                            data-key="cert_msg1">
                            I hereby certify that the scholar has not previously attended any recognized school or
                            institution. <span class="text-red-500">*</span>
                        </label>
                    </div>
                    <div class="flex items-start bg-blue-50 p-3 rounded-xl border border-blue-100">
                        <input type="checkbox" id="cert2" class="mt-1 h-5 w-5 text-blue-600 rounded cursor-pointer">
                        <label for="cert2" class="ml-4 text-sm text-gray-700 leading-relaxed font-semibold"
                            data-key="cert_msg2">
                            I hereby certify that the date of birth of the scholar is correct and I agree to abide by
                            the rules of the Police Modern School. <span class="text-red-500">*</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between mt-10">
                <button type="button" id="prevBtn" onclick="changeStep(-1)"
                    class="invisible bg-gray-200 text-gray-700 px-8 py-3 rounded-xl font-bold hover:bg-gray-300 transition flex items-center gap-2">
                    <span id="prevBtnText">Back</span>
                </button>
                <button type="button" id="nextBtn" onclick="changeStep(1)"
                    class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition shadow-lg flex items-center gap-2">
                    <span id="nextBtnText">Next</span>
                </button>
            </div>
        </form>

        <!-- STEP 7: Final Preview -->
        <div id="finalPreviewPage" class="hidden">
            <div class="preview-document relative">

                <!-- Dual Logos Header -->
                <div class="flex items-center justify-between border-b-2 border-black pb-4 mb-6">
                    <img src="../assets/images/logo/logo1.png" alt="Left Logo" class="w-24 h-auto"
                        onerror="this.src='https://via.placeholder.com/80?text=LOGO'">

                    <div class="text-center flex-1">
                        <h1 class="text-xl font-bold uppercase">POLICE MODERN SCHOOL 25<sup>TH</sup> BN PAC RAEBARELI
                        </h1>
                        <p class="font-bold text-sm" id="p_regNo">(Registration No.-568-71/2007-08)</p>
                        <div class="mt-3 inline-block border-2 border-black px-6 py-1">
                            <h2 class="text-lg font-bold" id="p_formTitle">APPLICATION FOR ADMISSION</h2>
                        </div>
                        <p class="italic text-[10px] mt-1" id="p_formDesc">(To be filled by parents or guardian of the
                            student to be admitted police Modern school)</p>
                    </div>

                    <img src="../assets/images/logo/logo1.png" alt="Right Logo" class="w-24 h-auto"
                        onerror="this.src='https://via.placeholder.com/80?text=LOGO'">
                </div>

                <!-- Photo Box -->
                <div class="absolute right-10 top-52">
                    <div id="photoPreview" class="student-photo-placeholder shadow-sm">
                        <span id="p_pastePhoto">PASTE PHOTOGRAPH HERE</span>
                    </div>
                </div>

                <!-- Document Content -->
                <div class="space-y-4">
                    <p><span id="pl_scholarName">Name of Scholar</span> <span id="p_scholarName"
                            class="dotted-line min-w-[400px]"></span></p>
                    <p><span id="pl_dob">Date of birth</span> <span id="p_dob" class="dotted-line min-w-[400px]"></span>
                    </p>
                    <p><span id="pl_class">Class to which admission is sought</span> <span id="p_targetClass"
                            class="dotted-line min-w-[300px]"></span></p>
                    <p><span id="pl_fatherName">Father's name</span> <span id="p_fatherNamePreview"
                            class="dotted-line min-w-[350px]"></span></p>
                    <p><span id="pl_fatherOcc">Father's Occupation</span> <span id="p_fatherOccPreview"
                            class="dotted-line min-w-[350px]"></span></p>

                    <div class="pl-8 flex gap-6">
                        <span>(a). <span id="pl_company">company</span> <span id="p_fCompany"
                                class="dotted-line min-w-[120px]"></span></span>
                        <span><span id="pl_post">Post</span> <span id="p_fPost"
                                class="dotted-line min-w-[100px]"></span></span>
                        <span><span id="pl_mobile">Mobile No.</span> <span id="p_fMobile"
                                class="dotted-line min-w-[120px]"></span></span>
                    </div>

                    <p>(b). <span id="pl_motherName">Mother's name and occupation</span> <span id="p_motherFullPreview"
                            class="dotted-line min-w-[400px]"></span></p>

                    <p class="font-bold mt-2" id="pl_fAddress">Father's address:-</p>
                    <div class="pl-8">
                        <p>(a). <span id="pl_perm">Permanent</span> <span id="p_permAddress"
                                class="dotted-line min-w-[480px]"></span></p>
                        <p>(b). <span id="pl_postal">Postal address</span> <span id="p_postAddress"
                                class="dotted-line min-w-[480px]"></span></p>
                    </div>

                    <p class="font-bold mt-2" id="pl_lg">Local guardian:-</p>
                    <div class="pl-8">
                        <p>(a). <span id="pl_gName">Name</span> <span id="p_gName"
                                class="dotted-line min-w-[480px]"></span>
                        </p>
                        <p>(b). <span id="pl_gAddr">Address</span> <span id="p_gAddress"
                                class="dotted-line min-w-[480px]"></span></p>
                        <p>(c). <span id="pl_gRel">Relationship</span> <span id="p_gRel"
                                class="dotted-line min-w-[150px]"></span></p>
                    </div>

                    <p><span id="pl_lastInst">Last Institution Attended</span> <span id="p_lastInst"
                            class="dotted-line min-w-[400px]"></span></p>
                    <p><span id="pl_tongue">Mother Tongue</span> <span id="p_tongue"
                            class="dotted-line min-w-[200px]"></span></p>
                    <p><span id="pl_religion">Religion & caste</span> <span id="p_religion"
                            class="dotted-line min-w-[300px]"></span></p>
                    <p><span id="pl_stayUp">Duration of stay of the scholar in U.P.</span> <span id="p_stayUp"
                            class="dotted-line min-w-[150px]"></span></p>


                    <div class="mt-8 pt-6 border-t border-black">
                        <p class="font-bold italic" id="p_entryMsg">If entry 7 is blank the following certificates must
                            be signed:-</p>
                        <p class="mt-4 leading-8"><span id="p_certPrefix">I hereby certify that</span> <span
                                id="p_scholarName2" class="dotted-line min-w-[250px]"></span> <span
                                id="p_certSuffix">has
                                not previously attended any recognized school of
                                institution.</span></p>

                        <div class="flex justify-end mt-10">
                            <div class="text-center">
                                <p class="mb-4">...................................................</p>
                                <p class="font-bold" id="pl_sig1">Signature of Parents/Guardian</p>
                            </div>
                        </div>

                        <p class="mt-10 italic font-bold" id="p_agreeMsg">I hereby certify that the date of the birth of
                            scholar is correct and I agree to abide by the rules of the Police Modern School.</p>

                        <div class="flex justify-between items-end mt-16">
                            <div>
                                <p><span id="pl_encl">Enclosure (if any)</span>:- ...................................
                                </p>
                            </div>
                            <div class="text-center">
                                <p class="mb-4">...................................................</p>
                                <p class="font-bold" id="pl_sig2">Signature of Parents/Guardian</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex flex-wrap justify-center gap-4 mt-8 no-print pb-10">
                <button type="button" onclick="editForm()"
                    class="bg-gray-500 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:bg-gray-600 transition flex items-center gap-2">
                    <span id="btn_edit">Edit Form</span>
                </button>
                <button type="button" onclick="window.print()"
                    class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold shadow-lg hover:bg-blue-700 transition flex items-center gap-2">
                    <span id="btn_print">Print Preview</span>
                </button>
                <button type="button" onclick="handleFinalSubmit()" id="btn_submit"
                    class="bg-green-600 text-white px-10 py-4 rounded-xl font-bold shadow-lg hover:bg-green-700 transition flex items-center gap-2">
                    <span id="btn_submit_text">Final Submit Application</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="submitModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl p-8 max-w-sm w-full text-center shadow-2xl">
            <div
                class="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2" id="modal_title">Submitted Successfully!</h3>
            <p class="text-gray-600 mb-6" id="modal_msg">Your admission form for Police Modern School has been
                successfully submitted.</p>
            <button onclick="location.reload()"
                class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700"
                id="modal_btn">Done</button>
        </div>
    </div>

    <script>
        const translations = {
            en: {
                label: "हिन्दी",
                stepPrefix: "Step",
                stepOf: "of",
                btn_next: "Next →",
                btn_prev: "← Back",
                btn_preview: "Generate Preview →",
                s1_title: "Step 1: Scholar Details",
                scholar_name: "Name of Scholar",
                dob: "Date of Birth",
                gender: "Gender",
                select_gender: "-- Select Gender --",
                target_class: "Class to which admission is sought",
                select_class: "-- Select Class --",
                photo_label: "Student Photo Preview",
                no_photo: "No photo selected",
                s2_title: "Step 2: Parents Details",
                father_head: "Father's Information",
                father_name: "Father's Name",
                father_occupation: "Father's Occupation",
                police_note: "Note: Fill Company and Post only if Father is a Police Employee.",
                company: "Company",
                post: "Post",
                mobile: "Mobile No.",
                mother_head: "Mother's Information",
                mother_name: "Mother's Name",
                mother_occ: "Mother's Occupation",
                s3_title: "Step 3: Address Details",
                perm_addr: "Permanent Address",
                post_addr: "Postal Address",
                s4_title: "Step 4: Local Guardian",
                g_name: "Guardian Name",
                g_addr: "Guardian Address",
                g_rel: "Relationship with Scholar",
                s5_title: "Step 5: Educational & Personal Details",
                last_inst: "Last Institution Attended",
                tongue: "Mother Tongue",
                religion: "Religion & Caste",
                stay_up: "Duration of stay in U.P.",
                app_date: "Date of Application",
                s6_title: "Step 6: Declaration",
                cert_msg1: "I hereby certify that the scholar has not previously attended any recognized school or institution.",
                cert_msg2: "I hereby certify that the date of birth of the scholar is correct and I agree to abide by the rules of the Police Modern School.",
                btn_edit: "Edit Form",
                btn_print: "Print Preview",
                btn_submit: "Final Submit Application",
                modal_title: "Submitted Successfully!",
                modal_msg: "Your admission form for Police Modern School has been successfully submitted.",
                modal_btn: "Done",
                // Preview Specific Labels
                p_regNo: "(Registration No.-568-71/2007-08)",
                p_formTitle: "APPLICATION FOR ADMISSION",
                p_formDesc: "(To be filled by parents or guardian of the student to be admitted police Modern school)",
                p_pastePhoto: "PASTE PHOTOGRAPH HERE",
                p_entryMsg: "If entry 7 is blank the following certificates must be signed:-",
                p_certPrefix: "I hereby certify that",
                p_certSuffix: "has not previously attended any recognized school of institution.",
                p_agreeMsg: "I hereby certify that the date of the birth of scholar is correct and I agree to abide by the rules of the Police Modern School.",
                sig_text: "Signature of Parents/Guardian",
                p_encl: "Enclosure (if any)",
                // Steps mapping
                stepNames: ["Scholar Details", "Parents Details", "Address Details", "Local Guardian", "Educational Details", "Required Documents", "Declarations", "Full Preview"],
                // Document upload labels
                doc_note: "Please upload all required documents in image format (JPEG, PNG) only. Maximum file size: 1MB per document.",
                birth_cert: "Birth Certificate",
                aadhar_card: "Aadhar Card",
                caste_cert: "Caste Certificate",
                domicile_cert: "Domicile Certificate",
                uploaded_docs: "Uploaded Documents",
                no_docs_uploaded: "No documents uploaded yet",
                s6_title: "Step 6: Required Documents"
            },
            hi: {
                label: "English",
                stepPrefix: "चरण",
                stepOf: "/",
                btn_next: "अगला →",
                btn_prev: "← वापस",
                btn_preview: "पूर्वावलोकन देखें →",
                s1_title: "चरण 1: छात्र का विवरण",
                scholar_name: "छात्र का नाम",
                dob: "जन्म तिथि",
                gender: "लिंग",
                select_gender: "-- लिंग चुनें --",
                target_class: "कक्षा जिसके लिए प्रवेश चाहिए",
                select_class: "-- कक्षा चुनें --",
                photo_label: "छात्र फोटो प्रीव्यू",
                no_photo: "कोई फोटो नहीं चुनी गई",
                s2_title: "चरण 2: माता-पिता का विवरण",
                father_head: "पिता की जानकारी",
                father_name: "पिता का नाम",
                father_occupation: "पिता का व्यवसाय",
                police_note: "सूचना: यदि पिता पुलिस कर्मचारी हैं, तभी 'Company' और 'Post' भरें।",
                company: "कंपनी (इकाई)",
                post: "पद",
                mobile: "मोबाइल नंबर",
                mother_head: "माता की जानकारी",
                mother_name: "माता का नाम",
                mother_occ: "माता का व्यवसाय",
                s3_title: "चरण 3: पता का विवरण",
                perm_addr: "स्थायी पता",
                post_addr: "पत्राचार का पता",
                s4_title: "चरण 4: स्थानीय अभिभावक",
                g_name: "अभिभावक का नाम",
                g_addr: "अभिभावक का पता",
                g_rel: "छात्र के साथ संबंध",
                s5_title: "चरण 5: शैक्षणिक और व्यक्तिगत विवरण",
                last_inst: "पिछला संस्थान जहाँ शिक्षा प्राप्त की",
                tongue: "मातृभाषा",
                religion: "धर्म और जाति",
                stay_up: "उत्तर प्रदेश में रहने की अवधि",
                app_date: "आवेदन की तिथि",
                s6_title: "चरण 6: घोषणा",
                cert_msg1: "मै प्रमाणित करता/करती हूँ कि छात्र ने पहले किसी मान्यता प्राप्त स्कूल या संस्था में शिक्षा प्राप्त नहीं की है।",
                cert_msg2: "मै प्रमाणित करता/करती हूँ कि छात्र की जन्मतिथि सही है और मै पुलिस मॉडर्न स्कूल के सभी नियमों का पालन करने के लिए सहमत हूँ।",
                btn_edit: "फॉर्म सुधारें",
                btn_print: "प्रिंट करें",
                btn_submit: "फाइनल सबमिट करें",
                modal_title: "सफलतापूर्वक जमा हुआ!",
                modal_msg: "पुलिस मॉडर्न स्कूल के लिए आपका प्रवेश फॉर्म सफलतापूर्वक जमा कर दिया गया है।",
                modal_btn: "ठीक है",
                // Preview Specific Labels
                p_regNo: "(पंजीकरण संख्या-568-71/2007-08)",
                p_formTitle: "प्रवेश हेतु आवेदन पत्र",
                p_formDesc: "(प्रवेश पाने वाले छात्र के माता-पिता या अभिभावक द्वारा भरा जाना है)",
                p_pastePhoto: "यहाँ फोटो चिपकाएँ",
                p_entryMsg: "यदि प्रविष्टि 7 खाली है तो निम्नलिखित प्रमाण पत्र हस्ताक्षरित होने चाहिए:-",
                p_certPrefix: "मै एतद्द्वारा प्रमाणित करता हूँ कि",
                p_certSuffix: "ने पहले किसी मान्यता प्राप्त स्कूल या संस्थान में शिक्षा प्राप्त नहीं की है।",
                p_agreeMsg: "मै एतद्द्वारा प्रमाणित करता हूँ कि छात्र की जन्मतिथि सही है और मै पुलिस मॉडर्न स्कूल के नियमों का पालन करने के लिए सहमत हूँ।",
                sig_text: "माता-पिता/अभिभावक के हस्ताक्षर",
                p_encl: "संलग्नक (यदि कोई हो)",
                // Steps mapping
                stepNames: ["छात्र विवरण", "अभिभावक विवरण", "पता विवरण", "स्थानीय अभिभावक", "शैक्षणिक विवरण", "आवश्यक दस्तावेज़", "घोषणा", "पूर्ण पूर्वावलोकन"],
                // Document upload labels
                doc_note: "कृपया सभी आवश्यक दस्तावेज़ केवल इमेज प्रारूप (JPEG, PNG) में अपलोड करें। अधिकतम फ़ाइल आकार: प्रति दस्तावेज़ 1MB।",
                birth_cert: "जन्म प्रमाण पत्र",
                aadhar_card: "आधार कार्ड",
                caste_cert: "जाति प्रमाण पत्र",
                domicile_cert: "निवास प्रमाण पत्र",
                uploaded_docs: "अपलोड किए गए दस्तावेज़",
                no_docs_uploaded: "अभी तक कोई दस्तावेज़ अपलोड नहीं किया गया",
                s6_title: "चरण 6: आवश्यक दस्तावेज़",
                s7_title: "चरण 7: घोषणा"
            }
        };

        let currentLang = 'en';
        let currentStep = 1;
        const totalSteps = 8;

        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'hi' : 'en';
            updateLanguageUI();
        }

        function updateLanguageUI() {
            const langData = translations[currentLang];
            document.getElementById('langLabel').innerText = langData.label;

            // Update all elements with data-key
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if (langData[key]) el.innerText = langData[key];
            });

            // Update placeholders if needed or static texts
            document.getElementById('prevBtnText').innerText = langData.btn_prev;
            updateUI(); // Refresh step names and buttons
        }

        function handleInstantPreview(input) {
            const previewContainer = document.getElementById('instantPhotoPreview');
            const file = input.files[0];

            if (file) {
                // Validation: Size (500KB = 500 * 1024 bytes)
                if (file.size > 512000) {
                    alert("File size exceeds 500KB. Please upload a smaller image.");
                    input.value = ""; // Clear input
                    previewContainer.innerHTML = `<span class="text-red-500 text-xs text-center p-2">Image too large</span>`;
                    return;
                }

                // Validation: Type
                const validTypes = ['image/jpeg', 'image/png', 'image/jpg'];
                if (!validTypes.includes(file.type)) {
                    alert("Invalid file format. Please upload JPG, JPEG, or PNG.");
                    input.value = "";
                    previewContainer.innerHTML = `<span class="text-red-500 text-xs text-center p-2">Invalid format</span>`;
                    return;
                }

                const reader = new FileReader();
                reader.onload = function (e) {
                    previewContainer.innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover">`;
                }
                reader.readAsDataURL(file);
            }
        }

        function changeStep(n) {
            if (n === 1) {
                const activeStep = document.getElementById(`step${currentStep}`);
                const activeStepFields = activeStep.querySelectorAll('input[required], select[required], textarea[required]');
                let isValid = true;
                let firstInvalid = null;

                // Remove existing error messages
                activeStep.querySelectorAll('.error-msg').forEach(e => e.remove());

                for (let field of activeStepFields) {
                    if (!field.value.trim()) {
                        isValid = false;
                        field.classList.add('border-red-500', 'ring-2', 'ring-red-200');

                        // Add inline error message
                        const errorSpan = document.createElement('span');
                        errorSpan.className = 'error-msg text-red-500 text-xs font-semibold mt-1 block';
                        errorSpan.innerText = currentLang === 'hi' ? "यह फ़ील्ड अनिवार्य है।" : "This field is required.";
                        field.parentNode.appendChild(errorSpan);

                        if (!firstInvalid) firstInvalid = field;
                    } else {
                        field.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
                    }
                }

                if (!isValid) {
                    if (firstInvalid) {
                        firstInvalid.focus();
                        firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                    // Optional: Validation summary toast or alert
                    // alert(currentLang === 'hi' ? "कृपया सभी अनिवार्य फ़ील्ड भरें।" : "Please fill all required fields.");
                    return;
                }

                if (currentStep === 7) {
                    const cert1 = document.getElementById('cert1');
                    const cert1Container = document.getElementById('cert1Container');
                    const cert2 = document.getElementById('cert2');
                    let checkboxValid = true;

                    // Remove existing error messages
                    cert1Container.classList.remove('border-red-500', 'border-2');
                    cert2.parentNode.classList.remove('border-red-500', 'border-2');

                    // Check cert1 only if it's visible
                    if (!cert1Container.classList.contains('hidden') && !cert1.checked) {
                        cert1Container.classList.add('border-red-500', 'border-2');
                        checkboxValid = false;
                    }

                    if (!cert2.checked) {
                        cert2.parentNode.classList.add('border-red-500', 'border-2');
                        checkboxValid = false;
                    }

                    if (!checkboxValid) {
                        // Scroll to top of declaration section or first error
                        document.getElementById('step7').scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return;
                    }
                }
            }
            document.getElementById(`step${currentStep}`).classList.remove('active');
            currentStep += n;
            if (currentStep > 7) { showPreview(); return; }
            document.getElementById(`step${currentStep}`).classList.add('active');
            updateUI();
        }

        function updateUI() {
            const langData = translations[currentLang];
            const percent = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = percent + "%";
            document.getElementById('stepIndicator').innerText = `${langData.stepPrefix} ${currentStep} ${langData.stepOf} ${totalSteps}`;
            document.getElementById('stepName').innerText = langData.stepNames[currentStep - 1];

            document.getElementById('prevBtn').style.visibility = currentStep === 1 ? 'hidden' : 'visible';
            document.getElementById('nextBtnText').innerText = currentStep === 7 ? langData.btn_preview : langData.btn_next;
        }

        function showPreview() {
            const langData = translations[currentLang];
            const form = document.getElementById('admission-form');
            const formData = new FormData(form);

            // Map values
            for (const [key, value] of formData.entries()) {
                const displayElem = document.getElementById('p_' + key);
                if (displayElem) displayElem.innerText = value || '__________';
            }

            // Preview specific labels
            document.getElementById('p_regNo').innerText = langData.p_regNo;
            document.getElementById('p_formTitle').innerText = langData.p_formTitle;
            document.getElementById('p_formDesc').innerText = langData.p_formDesc;

            // Format Date of Birth to dd/mm/yyyy
            const dobInput = formData.get('dob');
            if (dobInput) {
                const [year, month, day] = dobInput.split('-');
                if (year && month && day) {
                    document.getElementById('p_dob').innerText = `${day}/${month}/${year}`;
                }
            }

            // Photo Preview Logic
            const photoInput = document.getElementById('studentPhotoInput');
            const photoPreviewBox = document.getElementById('photoPreview');

            if (photoInput.files && photoInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    photoPreviewBox.innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover">`;
                };
                reader.readAsDataURL(photoInput.files[0]);
            } else {
                photoPreviewBox.innerHTML = `<span id="p_pastePhoto">${langData.p_pastePhoto}</span>`;
            }

            document.getElementById('pl_scholarName').innerText = langData.scholar_name;
            document.getElementById('pl_dob').innerText = langData.dob;
            document.getElementById('pl_class').innerText = langData.target_class;
            document.getElementById('pl_fatherName').innerText = langData.father_name;
            document.getElementById('pl_fatherOcc').innerText = langData.father_occupation;
            document.getElementById('pl_company').innerText = langData.company;
            document.getElementById('pl_post').innerText = langData.post;
            document.getElementById('pl_mobile').innerText = langData.mobile;
            document.getElementById('pl_motherName').innerText = langData.mother_head;
            document.getElementById('pl_fAddress').innerText = langData.father_head + " " + (currentLang === 'hi' ? "का पता" : "Address");
            document.getElementById('pl_perm').innerText = langData.perm_addr;
            document.getElementById('pl_postal').innerText = langData.post_addr;
            document.getElementById('pl_lg').innerText = langData.s4_title;
            document.getElementById('pl_gName').innerText = langData.g_name;
            document.getElementById('pl_gAddr').innerText = langData.g_addr;
            document.getElementById('pl_gRel').innerText = langData.g_rel;
            document.getElementById('pl_lastInst').innerText = langData.last_inst;
            document.getElementById('pl_tongue').innerText = langData.tongue;
            document.getElementById('pl_religion').innerText = langData.religion;
            document.getElementById('pl_stayUp').innerText = langData.stay_up;

            document.getElementById('p_entryMsg').innerText = langData.p_entryMsg;
            document.getElementById('p_certPrefix').innerText = langData.p_certPrefix;
            document.getElementById('p_certSuffix').innerText = langData.p_certSuffix;
            document.getElementById('p_agreeMsg').innerText = langData.p_agreeMsg;
            document.getElementById('pl_sig1').innerText = langData.sig_text;
            document.getElementById('pl_sig2').innerText = langData.sig_text;
            document.getElementById('pl_encl').innerText = langData.p_encl;

            // Buttons
            document.getElementById('btn_edit').innerText = langData.btn_edit;
            document.getElementById('btn_print').innerText = langData.btn_print;
            document.getElementById('btn_submit').innerText = langData.btn_submit;
            document.getElementById('modal_title').innerText = langData.modal_title;
            document.getElementById('modal_msg').innerText = langData.modal_msg;
            document.getElementById('modal_btn').innerText = langData.modal_btn;

            const mName = formData.get('motherName') || '';
            const mOcc = formData.get('motherOcc') || '';
            const fName = formData.get('fatherName') || '';
            const fOcc = formData.get('fatherOcc') || '';

            document.getElementById('p_motherFullPreview').innerText = `${mName} (${mOcc})`;
            document.getElementById('p_fatherNamePreview').innerText = fName;
            document.getElementById('p_fatherOccPreview').innerText = fOcc;

            document.getElementById('p_scholarName2').innerText = formData.get('scholarName') || '__________';

            document.getElementById('admission-form').classList.add('hidden');
            document.getElementById('progressContainer').classList.add('hidden');
            document.getElementById('finalPreviewPage').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function handleFinalSubmit() {
            // Trigger the form submission handler defined in admission-form.js
            const form = document.getElementById('admission-form');
            if (form) {
                const submitEvent = new Event('submit', {
                    'bubbles': true,
                    'cancelable': true
                });
                form.dispatchEvent(submitEvent);
            }
        }

        function editForm() {
            document.getElementById('finalPreviewPage').classList.add('hidden');
            document.getElementById('admission-form').classList.remove('hidden');
            document.getElementById('progressContainer').classList.remove('hidden');

            // Reset to last step
            currentStep = 7;
            showStep(currentStep); // Function that shows the specific step
            window.scrollTo(0, 0);
        }

        // Generic File Preview
        function handleFilePreview(input, imgId, linkId) {
            const file = input.files[0];
            if (!file) return;

            // Validation: Size
            if (file.size > 500 * 1024) {
                alert("File is too large! Max 500KB allowed.");
                input.value = "";
                return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
                // If we have an img element for preview (optional)
                if (imgId && document.getElementById(imgId)) {
                    document.getElementById(imgId).src = e.target.result;
                    document.getElementById(imgId).parentElement.classList.remove('hidden');
                }
            };
            reader.readAsDataURL(file);
        }

        function handleLastInstChange() {
            const lastInst = document.getElementById('lastInstInput');
            const cert1Container = document.getElementById('cert1Container');
            const cert1 = document.getElementById('cert1');

            if (lastInst && cert1Container) {
                if (lastInst.value.trim() !== '') {
                    cert1Container.classList.add('hidden');
                    if (cert1) cert1.checked = false; // Uncheck if hidden
                } else {
                    cert1Container.classList.remove('hidden');
                }
            }
        }

        // Document upload handler with validation
        function handleDocumentUpload(input, previewId) {
            const file = input.files[0];
            const previewDiv = document.getElementById(previewId);
            const imagePreviewId = previewId.replace('Preview', 'Image');
            const imageDiv = document.getElementById(imagePreviewId);
            const langData = translations[currentLang];

            if (!file) {
                previewDiv.innerHTML = '';
                if (imageDiv) imageDiv.innerHTML = '';
                updateDocumentsList();
                return;
            }

            // Validate file type (images only)
            const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png'];
            if (!allowedTypes.includes(file.type)) {
                alert(currentLang === 'hi' ? 'केवल JPEG और PNG इमेज स्वीकार की जाती हैं!' : 'Only JPEG and PNG images are accepted!');
                input.value = '';
                previewDiv.innerHTML = `<span class="text-red-500"><i class="fas fa-times-circle mr-1"></i>${currentLang === 'hi' ? 'अमान्य फ़ाइल प्रकार' : 'Invalid file type'}</span>`;
                if (imageDiv) imageDiv.innerHTML = '';
                updateDocumentsList();
                return;
            }

            // Validate file size (1MB = 1024 * 1024 bytes)
            if (file.size > 1024 * 1024) {
                alert(currentLang === 'hi' ? 'फ़ाइल का आकार 1MB से अधिक है!' : 'File size exceeds 1MB!');
                input.value = '';
                previewDiv.innerHTML = `<span class="text-red-500"><i class="fas fa-times-circle mr-1"></i>${currentLang === 'hi' ? 'फ़ाइल बहुत बड़ी है' : 'File too large'}</span>`;
                if (imageDiv) imageDiv.innerHTML = '';
                updateDocumentsList();
                return;
            }

            // Show success message
            const sizeKB = (file.size / 1024).toFixed(2);
            previewDiv.innerHTML = `<span class="text-green-600"><i class="fas fa-check-circle mr-1"></i>${file.name} (${sizeKB} KB)</span>`;

            // Create image preview
            if (imageDiv) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    imageDiv.innerHTML = `
                        <div class="relative inline-block">
                            <img src="${e.target.result}" alt="Preview" class="max-w-xs max-h-48 rounded-lg border-2 border-blue-300 shadow-md">
                            <button type="button" onclick="removeDocument('${input.id}', '${previewId}')" 
                                class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors">
                                <i class="fas fa-times text-xs"></i>
                            </button>
                        </div>
                    `;
                };
                reader.readAsDataURL(file);
            }

            updateDocumentsList();
        }

        // Function to remove uploaded document
        function removeDocument(inputId, previewId) {
            const input = document.getElementById(inputId);
            const previewDiv = document.getElementById(previewId);
            const imagePreviewId = previewId.replace('Preview', 'Image');
            const imageDiv = document.getElementById(imagePreviewId);

            input.value = '';
            previewDiv.innerHTML = '';
            if (imageDiv) imageDiv.innerHTML = '';
            updateDocumentsList();
        }

        // Update the documents preview list
        function updateDocumentsList() {
            const listDiv = document.getElementById('documentsPreviewList');
            const langData = translations[currentLang];
            const documents = [
                { id: 'birthCert', label: langData.birth_cert },
                { id: 'aadharCard', label: langData.aadhar_card },
                { id: 'casteCert', label: langData.caste_cert },
                { id: 'domicileCert', label: langData.domicile_cert }
            ];

            let html = '';
            let hasDocuments = false;

            documents.forEach(doc => {
                const input = document.getElementById(doc.id);
                if (input && input.files && input.files[0]) {
                    hasDocuments = true;
                    const file = input.files[0];
                    const sizeKB = (file.size / 1024).toFixed(2);
                    html += `<div class="flex items-center justify-between bg-white p-2 rounded border border-gray-200">
                                <span><i class="fas fa-image text-blue-500 mr-2"></i><strong>${doc.label}:</strong> ${file.name}</span>
                                <span class="text-gray-500">${sizeKB} KB</span>
                            </div>`;
                }
            });

            if (!hasDocuments) {
                listDiv.innerHTML = `<p class="text-gray-500 italic" data-key="no_docs_uploaded">${langData.no_docs_uploaded}</p>`;
            } else {
                listDiv.innerHTML = html;
            }
        }

        // Initialize logic on load
        handleLastInstChange();

        updateUI();
    </script>
    <script type="module" src="../assets/js/admission-form.js"></script>
    <!-- Unregister Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(function (registrations) {
                for (let registration of registrations) {
                    registration.unregister();
                }
            });
        }
    </script>
</body>

</html>